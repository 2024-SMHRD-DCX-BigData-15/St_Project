<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="새우양식 관제시스템 대시보드" />
    <link rel="stylesheet" href="/css/dashboarddetail.css" />
    <title>관제센터 대시보드</title>
  </head>
  <body>
       <!-- 사이드바 -->
       <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <h2>메뉴</h2>
        </div>
        <ul class="sidebar-menu">
          <li>
            <a href="javascript:void(0)" class="toggle-menu">수조 관리 시스템 1</a>
            <ul class="sub-menu">
              <li><a href="/edit/{id}">회원 수정</a></li>
              <li><a href="/delete">회원 탈퇴</a></li>
            </ul>
            <li><a href="#">수조 관리 시스템 2</a></li>
            <li><a href="#">수조 관리 시스템 3</a></li>
            <li><a href="#">수조 관리 시스템 4</a></li>
          </li>
        </ul>
      </div>

      <!-- 햄버거 메뉴 아이콘 -->
      <div class="hamburger-menu" id="hamburger-menu">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
      </div>

      <!-- 메인 콘텐츠 -->
      <main class="main-content">
        <header class="header">
          <h1 class="page-title">세부관제시스템</h1>
          
          <div class="user-info">
          
            <div th:if="${session.loginUser != null}">
    		<p th:text="${session.loginUser.userName}"></p> <!-- 로그인된 사용자 이름 출력 -->
		  </div>
		    <button class="logout-btn" onclick="handleLogout()">로그아웃</button> <!-- ✅ 수정된 로그아웃 버튼 -->
          </div>
          </div>
        </header>

        <!-- 6개의 데이터 카드 -->
        <section class="dashboard-cards">
          <!-- 첫 번째 카드 - 산성도 -->
          <div class="card card-ph">
            <h3>산성도</h3>
            <div class="data-container">
              <canvas id="chart-1"></canvas>
            </div>
          </div>

          <!-- 두 번째 카드 - 용존산소 -->
          <div class="card card-oxygen">
            <h3>용존산소</h3>
            <div class="data-container">
              <canvas id="chart-2"></canvas>
            </div>
          </div>

          <!-- 세 번째 카드 - 수온 -->
          <div class="card card-temperature">
            <h3>수온</h3>
            <div class="data-container">
              <canvas id="chart-3"></canvas>
            </div>
          </div>

          <!-- 네 번째 카드 - 염도 -->
          <div class="card card-salinity">
            <h3>염도</h3>
            <div class="data-container">
              <canvas id="chart-4"></canvas>
            </div>
          </div>

          <!-- 다섯 번째 카드 - 암모니아 -->
          <div class="card card-ammonia">
            <h3>암모니아</h3>
            <div class="data-container">
              <canvas id="chart-5"></canvas>
            </div>
          </div>

          <!-- 여섯 번째 카드 - 아질산 -->
          <div class="card card-nitrite">
            <h3>아질산</h3>
            <div class="data-container">
              <canvas id="chart-6"></canvas>
            </div>
          </div>
        </section>

        <!-- 수조정보와 실시간 그래프 -->
        <section class="dashboard-cards">
		    <div class="tank-info">
			    <h4>수조정보</h4>
			    <p><strong>수조 ID:</strong> <span th:text="${selectedTank?.tankIdx ?: '정보 없음'}"></span></p>
			    <p><strong>직경:</strong> <span th:text="${selectedTank?.tankWidth ?: '정보 없음'}"></span> cm</p>
			    <p><strong>높이:</strong> <span th:text="${selectedTank?.tankHeight ?: '정보 없음'}"></span> cm</p>
			    <p><strong>위치:</strong> <span th:text="${selectedTank?.tankLocation ?: '정보 없음'}"></span></p>
			    <p><strong>품종:</strong> <span th:text="${selectedTank?.fishType ?: '정보 없음'}"></span></p>
			    <p><strong>사육 개시일:</strong> 
			    <span th:text="${selectedTank?.startedAt != null ? #temporals.format(selectedTank.startedAt, 'yyyy-MM-dd') : '정보 없음'}"></span>
			</p>

			    <canvas id="tank-data"></canvas>
			</div>
          <div class="card card-graph">
            <h2>실시간 그래프</h2>
            <div class="graph-container">
              <!-- AI 허브 데이터를 활용한 그래프 삽입 영역 /30초마다 변경되게 -->
              <canvas id="aihubGraph"></canvas>
            </div>
          </div>
        </section>
      </main>
    </div>

        <script>
          document.getElementById('hamburger-menu').addEventListener('click', function() {
      // 사이드바 열기/닫기 토글
      document.getElementById('sidebar').classList.toggle('open');
      
      // 햄버거 메뉴 애니메이션
      this.classList.toggle('open');
    });
          
       // 알림 로그
	        function toggleNotifications() {
	  var log = document.getElementById("notificationLog");
	  log.style.display = log.style.display === "block" ? "none" : "block";
	}


    </script>


  </body>
</html>